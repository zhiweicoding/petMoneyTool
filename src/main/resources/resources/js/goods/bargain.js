"use strict";define("common/bargain",["jquery","data/intent","widget/dialog/success","log","common/util","data/wechat-entry","jquery.cookie"],function(r,a,e,i,n,s){function t(){r("#bargain_submit").on("click",function(){var s=r("#bargain_modal"),t=r("#bargain_mobile_number"),l=r.trim(t.val()),o=r("#bargain_phone_source"),c=r("#bargain_new_price"),d=r("#bargain_old_price"),m=r.trim(c.val());if(""===m||isNaN(m))return c.addClass("error"),void c.parent().children('p[class="error"]').html("*您输入的价格不正确");if(c.removeClass("error"),c.parent().children('p[class="error"]').html(""),!n.isMobile(l))return t.addClass("error"),void t.parent().children('p[class="error"]').html("*手机号格式不正确");t.removeClass("error"),t.parent().children('p[class="error"]').html("");var p=c.val(),g=parseFloat(d.val()),_=r(".detail-wrapper").data("id"),h=o.val(),b=c.val(),u="PC";if(r(this).data("car-id")&&(_=r(this).data("car-id"),h=r(this).data("phone-source"),g=r(this).data("old-price")),p<=0)return void c.parent().children('p[class="error"]').html("*您输入的价格不正确");if(p>g)return c.addClass("error"),c.siblings('p[class="error"]').html("*出价已经高于原价啦"),void i.push(["_trackEvent","pc_detail_bargain_error","click","car_id_"+_]);c.removeClass("error"),c.siblings('p[class="error"]').html("");var v={car_id:_,phone:l,source:h,price:b,type:u,owner_price:g};s.fullscreen("hide"),a("bargain",v,function(a){var i=parseInt(a.status,10);if(0===i){"car-detail"===RRC.pageName&&(RRC.SHOW_DETAIL_LAYER_MASK=!1),r("#bargain_mobile_number").val(""),r("#bargain_new_price").val("");var t="";n.isSpring()?(t=n.getPCIntentSuccessTips("kanjia"),Array.isArray(t)&&(t=t.map(function(r){return'<p style="margin-bottom: 5px;">'+r+"</p>"}).join("")),t='<div class="confirm__message">'+t+"</div>"):t=a.notice_message,e("提交成功",t,"//img1.rrcimg.com/dist/pc/images/default-qr-34130988.png")}else 100===i?(s.fullscreen("show"),r("#bargain_new_price").val("").focus(),s.find(".dialog-message").html(a.notice_message),s.find(".dialog-title").html("您的出价有点低哦")):(r("#bargain_mobile_number").val(""),r("#bargain_new_price").val(""))},"//img1.rrcimg.com/dist/pc/images/default-qr-34130988.png")})}function l(){r(".bargain-error").hide(),c.find(".dialog-title").html("请输入您的期望价格"),0!==r(".error").length&&(r("#bargain_new_price").val("").removeClass("error").css("font-size","14px"),r("#bargain_new_price").parent().children('p[class="error"]').html("")),0!==r(".error").length&&(r("#bargain_mobile_number").val("").removeClass("error"),r("#bargain_mobile_number").parent().children('p[class="error"]').html(""));var a=r.cookie("rrc_login_phone");a&&r("#bargain_mobile_number").val(a),c.fullscreen({backdrop:"static",show:!0})}function o(){return!!n.isFromBdOther()&&(t(),void r(".js-bargain").on("click",function(a){s.replaceAppointment("2701");var e=r("#bargain_submit"),i=r(this).data("old-price");r("#bargain_modal .dialog-message").html('车主报价：<span class="price"></span>万'),a.preventDefault(),e.data({"car-id":r(this).data("car-id"),"phone-source":r(this).data("phone-source"),"old-price":r(this).data("old-price")}),l(),i&&r("#bargain_modal .dialog-message .price").html(parseFloat(i).toFixed(2))}))}var c=r("#bargain_modal");return{init:t,show:l,initCarListBargain:o}});
//# sourceMappingURL=bargain-27a889a1.js.map
